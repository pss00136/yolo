<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="lot">

	<resultMap type="lotlistVO" id="lotlistMap">
		<result column="priimg_num" property="priimg_num" />
		<result column="priimg_path" property="priimg_path" />
		<result column="priimg_name" property="priimg_name" />
		<result column="pri_num" property="pri_num" />
		<result column="h_num" property="h_num" />
		<result column="pri_type" property="pri_type" />
		<result column="pri_charge" property="pri_charge" />
		<result column="pri_booktype" property="pri_booktype" />
		<result column="pri_title" property="pri_title" />
		<result column="pri_addr" property="pri_addr" />
		<result column="pri_tag" property="pri_tag" />
		<result column="pri_content" property="pri_content" />
		<result column="pri_info" property="pri_info" />
		<result column="p_category" property="pCategory" />
		<result column="pri_account" property="pri_account" />
		<result column="pri_weekprice" property="pri_weekprice" />
		<result column="pri_weekendprice" property="pri_weekendprice" />
		<result column="pri_facility" property="pri_facility" />
		<result column="pri_minpeople" property="pri_minpeople" />
		<result column="pri_maxpeople" property="pri_maxpeople" />
		<result column="pri_weekdayo" property="pri_weekdayo" />
		<result column="pri_weekdaye" property="pri_weekdaye" />
		<result column="pri_weekendo" property="pri_weekendo" />
		<result column="pri_weekende" property="pri_weekende" />
		<result column="pri_lat" property="pri_lat" />
		<result column="pir_long" property="pir_long" />
		<result column="pri_tel" property="pri_tel" />
		<result column="pri_web" property="pri_web" />
		<result column="pri_bookcount" property="pri_bookcount" />
		<result column="pri_bookmark" property="pri_bookmark" />
		<result column="pri_regdate" property="pri_regdate" />
		<result column="pri_confirm" property="pri_confirm" />
	</resultMap>

	<insert id="lotinput" parameterType="privateVO">
		INSERT INTO
		privatelot(pri_num,h_num,pri_type,pri_booktype,pri_charge,pri_title,pri_addr,pri_tag,
		pri_content,pri_info,pri_account,pri_weekprice,
		pri_weekendprice,pri_facility,pri_minpeople,pri_maxpeople,
		pri_weekdayo,pri_weekdaye,pri_weekendo,pri_weekende,
		pri_tel,pri_web,pri_regdate)
		VALUES(concat('pri_', PRIVATELOT_NO_SEQ.nextVal),#{h_num},#{pri_type},#{pri_booktype},#{pri_charge},#{pri_title},
		#{pri_addr},#{pri_tag},#{pri_content},#{pri_info},#{pri_account},#{pri_weekprice},
		#{pri_weekendprice},#{pri_facility},#{pri_minpeople},#{pri_maxpeople},
		#{pri_weekdayo},#{pri_weekdaye},#{pri_weekendo},#{pri_weekende},
		#{pri_tel},#{pri_web}, to_char(sysdate,'yy/MM/dd') )
	</insert>

	<insert id="lotimginput" parameterType="primgVO">
		<selectKey keyColumn='pri_num' keyProperty='pri_num' order='BEFORE'
			resultType='string'>
			SELECT concat('pri_', PRIVATELOT_NO_SEQ.currval) FROM dual
		</selectKey>
		insert into privateimage(priimg_num, pri_num ,priimg_name,
		priimg_path)
		values(concat('priimg_', PRIVATEIMAGE_NO_SEQ.nextVal), #{pri_num}, #{priimg_name}, #{priimg_path})
	</insert>

	<select id="lotlistview" resultMap="lotlistMap">
	 select i.priimg_name priimg_name, p.pri_weekprice pri_weekprice, p.pri_title pri_title, p.pri_addr pri_addr, p.pri_num pri_num
     from privatelot p JOIN privateimage i
     ON p.pri_num = i.pri_num
	</select>
	
	<insert parameterType="yolo.host.dto.EntrepreneurVO" id="entrepreneurinput">
	 insert into ENTREPRENEUR(E_NUM, H_NUM, E_TYPE, E_TITLE, E_ADDR, E_RNUM, E_FNAME, E_FPATH)
	 VALUES (concat('e_',ENTREPRENEUR_NO_SEQ.nextval),'21', #{e_type}, #{e_title}, #{e_addr}, #{e_rnum}, #{e_fname}, #{e_fpath})
	</insert>
	
	
	<select id="lotdetailview" parameterType="lotlistVO" resultMap="lotlistMap">
	 SELECT i.priimg_name priimg_name, p.pri_title pri_title, p.pri_weekprice pri_weekprice, p.pri_addr pri_addr, p.pri_tag pri_tag,
	 p.pri_content pri_content, p.pri_facility pri_facility
	 FROM privatelot p JOIN privateimage i
	 ON p.pri_num = i.pri_num
	 WHERE p.pri_num = #{pri_num}
	</select>

</mapper>